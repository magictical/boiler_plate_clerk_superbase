---
name: RB-01 빌더 모드 선택 MVP
overview: 루틴 빌더 진입 시 Guest/Regular 권한을 체크하고, 모드 선택(AI Coach vs Custom) 화면을 구현합니다.
status: 진행 중
todo_ref: docs/TODO.md § 4.1
---

# RB-01: 빌더 모드 선택 (Mode Select) MVP 구현 계획

> **상태**: 진행 중 (TODO 4.1)  
> **관리 위치**: `docs/implementation-plans/`

---

## 1. 요구사항 정리

| 출처 | 내용 |
|------|------|
| PRD 3.2 | Guest 유저 접근 시 [설정 유도 팝업] 출력 후 차단. Regular 유저는 모드 선택 화면 진입. |
| TODO 4.1 | `app/routine-builder/page.tsx` 생성. Guest 체크 → GatePopup. 카드 A(AI), 카드 B(Custom). |
| Design Ref 08 | 헤더(뒤로가기), 헤드라인, 카드 A(AI Coach - Neon/Image), 카드 B(Custom - Dark/Image). |
| Userflow | 진입 → Guest? → (Yes: 팝업 → 온보딩/취소) / (No: 모드 선택 → AI/Custom). |

---

## 2. 아키텍처 및 데이터 흐름

```mermaid
flowchart TD
    subgraph Page ["app/routine-builder/page.tsx"]
        A[진입] --> B[getProfileForHome]
        B --> C{isGuest?}
        C -->|Yes| D[GuestGate (Client)]
        C -->|No| E[ModeSelectUI]
        
        subgraph GuestGate
            D --> D1[GatePopup 표시]
            D1 -->|취소| D2[router.back()]
            D1 -->|확인| D3[/onboarding/gym-select]
        end

        subgraph ModeSelectUI
            E --> F[Header (Back)]
            E --> G[Headline]
            E --> H[ModeSelectCard (AI)]
            E --> I[ModeSelectCard (Custom)]
        end
    end
```

---

## 3. 구현 범위

### 3.1 컴포넌트
- **`components/routine-builder/GuestGate.tsx`**: Guest 접근 차단용 클라이언트 컴포넌트.
- **`components/routine-builder/ModeSelectCard.tsx`**: AI/Custom 모드 선택 카드. Design Ref 08 스타일 적용.
- **`components/common/GatePopup.tsx`**: `onCancel` prop 추가 (취소 시 뒤로가기 처리를 위해).

### 3.2 페이지
- **`app/routine-builder/page.tsx`**: Server Component. 권한 체크 및 UI 렌더링.

### 3.3 이미지 리소스 (Design Ref 08)
- AI Card: `https://lh3.googleusercontent.com/aida-public/AB6AXuBEZyBgBUIuvy7YE1bO0c-vgDs-FCrve9-5wlQ0A97Ua38b6rCbz3Gm2z9MZbfy1IRSjTCfAumPPe4w42bclM5TYtRYtg5YFwlgOlNZc0xbnVAcBQGohx-VHmCCuRYweU-jyLg-Bvdwc9-ziJQ8vc2Cu1jqHsGQWINyVo-TFCoSd0Kfvife48NK0nP_P0RgIb3xoh5piiML-Oe_Ax1oMJtko0nuMezRxZtquCQBCNTuPwp6RT6RUZD5EnBDJ7Q8ZlFECX4sizREYt96`
- Custom Card: `https://lh3.googleusercontent.com/aida-public/AB6AXuA_HS2VGfyKjXBdSxtqY9JW7M4HeYvC-x5XY4ym31c8wzMzMZJ-nUGWI0mWU7PetCPZH3FNUYI3CsZhHVnrOUCMUlxIRdGLYeJsPNBJMaYewJsUvSP3g75kYItghqyGzS9ZQia1Zp7ZaikXz_snZee6TMPOx55s2Lwa6t8J2OOzywvNbyiBFNNLGwA2-zIo7JgSYTQgpikEV6b1tmBB0iiUVqXrTjBBA3_6-jr5diKorD6x2JCZlb_i8H22QFu8TXKrAxvHSvzrt6YX`

---

## 4. 작업 순서

1. `components/common/GatePopup.tsx` 수정 (`onCancel` prop 추가).
2. `components/routine-builder/GuestGate.tsx` 구현.
3. `components/routine-builder/ModeSelectCard.tsx` 구현.
4. `app/routine-builder/page.tsx` 구현.
